From rb@er @end|ng |rom @t@u@edu  Tue Nov  4 18:22:57 2025
From: rb@er @end|ng |rom @t@u@edu (Robert Baer)
Date: Tue, 4 Nov 2025 11:22:57 -0600
Subject: [R] Did behavior of "paired" argument in t.test() change?
Message-ID: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>

Hi all,

Did the behavior of base t.test() subtly change with respect to the 
paired argument?

I think this code used to work with long form data, but now it seems not 
to? work:

 ? ? # Example long format data
 ? ? data_long <- data.frame(
 ? ? ? value = c(10, 12, 15, 8, 9, 11),
 ? ? ? time = factor(rep(c("before", "after"), each = 3))
 ? ? )

 ? ? t.test(value ~ time, data = data_long, paired = TRUE)

# Errorin t.test.formula(value ~ time, data = data_long, paired = TRUE) 
: # cannot use 'paired' in formula method

A quick Google seems to suggest that the above code should still work. 
What am I missing?

-------------------------------

Less sure about this one ...

Also, I thought it had always been possible to use x = "difference 
scores" in t.test(..., paired = TRUE) as long as y = NULL. My memory 
about this is less secure than the behavior above.

Control = c(10, 12, 15) Treat = c(8, 9, 11) data_wide <- data.frame( 
Control, Treat, Diff = Treat - Control) t.test(data_wide$Diff, NULL, 
"two.sided", 0, paired = FALSE) # works but y = NULL, mu = 0 mostly 
implies difference scores

t.test(data_wide$Diff, NULL, "two.sided", 0, paired = TRUE) # fails but 
if y = NULL the value of paired should not matter should it?

For y, help says "y an optional (non-empty) numeric vector of data 
values". I take this to imply that x = compared to a population mean 
hypothesis whenever y = NULL. Why should the value of paired influence 
the outcome?

Just bad memory? on my part?

R.version _ platform x86_64-w64-mingw32 arch x86_64 os mingw32 crt ucrt 
system x86_64, mingw32 status major 4 minor 5.1 year 2025 month 06 day 
13 svn rev 88306 language R version.string R version 4.5.1 (2025-06-13 
ucrt) nickname Great Square Root


-- 
---
Robert W. Baer, Ph.D.
Professor of Physiology
Kirksville College of Osteopathic Medicine
A.T. Still Univerisity of Health Sciences
800 W. Jefferson St.
Kirksville, MO 63501

	[[alternative HTML version deleted]]


From |kry|ov @end|ng |rom d|@root@org  Tue Nov  4 18:40:21 2025
From: |kry|ov @end|ng |rom d|@root@org (Ivan Krylov)
Date: Tue, 4 Nov 2025 20:40:21 +0300
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
Message-ID: <20251104204021.0e690228@Tarkus>

? Tue, 4 Nov 2025 11:22:57 -0600
Robert Baer via R-help <r-help at r-project.org> ?????:

> Errorin t.test.formula(value ~ time, data = data_long, paired =
> TRUE) :
> cannot use 'paired' in formula method

This was changed in R-4.4.0:
https://bugs.r-project.org/show_bug.cgi?id=14359

The news item (see news(grepl('paired', Text))) recommends the use of
Pair(x1, x2) ~ 1 instead of the 'paired' argument. A further fix is
currently in R-devel (but not R-patched): without it, Pair(x1, x2) does
not handle the 'subset' argument.

-- 
Best regards,
Ivan


From petr@p|k @end|ng |rom gm@||@com  Tue Nov  4 18:39:50 2025
From: petr@p|k @end|ng |rom gm@||@com (Petr Pikal)
Date: Tue, 4 Nov 2025 18:39:50 +0100
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
Message-ID: <CAO8Egw_cObDHRMg5qxg61f3gkeq_5yPE4_EHqzZCfdqqwKrF6Q@mail.gmail.com>

Hallo

According to recent documentation this works for paired t.test.
t.test(Pair(value,time)~1, data=data_long)

It is the last example in help page.

And your second question seems to be also different from what help page
says:

If paired is TRUE then both x and y must be specified and they must be the
same length. Missing values are silently removed (in pairs if paired is TRUE
).

Cheers.
Petr


?t 4. 11. 2025 v 18:23 odes?latel Robert Baer via R-help <
r-help at r-project.org> napsal:

> Hi all,
>
> Did the behavior of base t.test() subtly change with respect to the
> paired argument?
>
> I think this code used to work with long form data, but now it seems not
> to  work:
>
>      # Example long format data
>      data_long <- data.frame(
>        value = c(10, 12, 15, 8, 9, 11),
>        time = factor(rep(c("before", "after"), each = 3))
>      )
>
>      t.test(value ~ time, data = data_long, paired = TRUE)
>
> # Errorin t.test.formula(value ~ time, data = data_long, paired = TRUE)
> : # cannot use 'paired' in formula method
>
> A quick Google seems to suggest that the above code should still work.
> What am I missing?
>
> -------------------------------
>
> Less sure about this one ...
>
> Also, I thought it had always been possible to use x = "difference
> scores" in t.test(..., paired = TRUE) as long as y = NULL. My memory
> about this is less secure than the behavior above.
>
> Control = c(10, 12, 15) Treat = c(8, 9, 11) data_wide <- data.frame(
> Control, Treat, Diff = Treat - Control) t.test(data_wide$Diff, NULL,
> "two.sided", 0, paired = FALSE) # works but y = NULL, mu = 0 mostly
> implies difference scores
>
> t.test(data_wide$Diff, NULL, "two.sided", 0, paired = TRUE) # fails but
> if y = NULL the value of paired should not matter should it?
>
> For y, help says "y an optional (non-empty) numeric vector of data
> values". I take this to imply that x = compared to a population mean
> hypothesis whenever y = NULL. Why should the value of paired influence
> the outcome?
>
> Just bad memory  on my part?
>
> R.version _ platform x86_64-w64-mingw32 arch x86_64 os mingw32 crt ucrt
> system x86_64, mingw32 status major 4 minor 5.1 year 2025 month 06 day
> 13 svn rev 88306 language R version.string R version 4.5.1 (2025-06-13
> ucrt) nickname Great Square Root
>
>
> --
> ---
> Robert W. Baer, Ph.D.
> Professor of Physiology
> Kirksville College of Osteopathic Medicine
> A.T. Still Univerisity of Health Sciences
> 800 W. Jefferson St.
> Kirksville, MO 63501
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From E@Vettor@zz| @end|ng |rom uke@de  Tue Nov  4 20:43:49 2025
From: E@Vettor@zz| @end|ng |rom uke@de (Eik Vettorazzi)
Date: Tue, 4 Nov 2025 20:43:49 +0100
Subject: [R] [EXT] Re:  A very small p-value
In-Reply-To: <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
References: <19B8367F-913D-4CF9-89F6-E6922EE61DA1@gmail.com>
 <CAO8Egw_AnEJpFEwp8P+uSBE0zJRdipn30NW8aB736y2HaOUSDg@mail.gmail.com>
Message-ID: <e810de9c-dbb2-4234-b592-5828ef29bc34@uke.de>

Hi,
Stepping briefly outside the R context, I noticed a statistical point in 
the text you linked that, in my opinion, isn't quite right. I believe 
there's a key misunderstanding here: The statement that the z-test does 
not depend on the number of cases is incorrect. The p-value of the 
z-test is ?just like other tests? very much dependent on the sample 
size, assuming the same mean difference and standard deviation.
The text you linked is actually calculating an Effect Size, which is 
(largely) independent of the sample size. Effect Size answers the 
question of how "relevant" or "large" the difference between groups is. 
This is fundamentally different from testing for "significant" differences.
Specifically, the crucial 1/\sqrt{n} term, which is necessary for 
calculating the standard error of the mean difference, seems to be 
missing from the presented formula for the z-score. I just wanted to 
quickly point this out.

Best regards

Am 27.10.2025 um 14:12 schrieb Petr Pikal:
> Hallo
> 
> The t test is probably not the best option in your case. With 95
> observations your data behave more like a population and you  may get
> better insight using z-test. See
> https://toxictruthblog.com/avoiding-little-known-problems-with-the-t-test/
> 
> Best regards.
> Petr
> 
> 
> <https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
> Neobsahuje
> ??dn? viry.www.avast.com
> <https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
> <#DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>
> 
> so 25. 10. 2025 v 11:46 odes?latel Christophe Dutang <dutangc at gmail.com>
> napsal:
> 
>> Dear list,
>>
>> I'm computing a p-value for the Student test and discover some
>> inconsistencies with the cdf pt().
>>
>> The observed statistic is 11.23995 for 95 observations, so the p-value is
>> very small
>>
>>> t_score <- 11.23995
>>> n <- 95
>>> print(pt(t_score, df = n-2, lower=FALSE), digits=22)
>> [1] 2.539746620181247991746e-19
>>> print(integrate(dt, lower=t_score, upper=Inf, df=n-2)$value, digits = 22)
>> [1] 2.539746631161970791961e-19
>>
>> But if I compute with pt(lower=TRUE), I got 0
>>
>>> print(1-pt(t_score, df = n-2, lower=TRUE), digits=22)
>> [1] 0
>>
>> Indeed, the p-value is lower than the epsilon machine
>>
>>> pt(t_score, df = n-2, lower=FALSE) < .Machine$double.eps
>> [1] TRUE
>>
>> Using the square of t statistic which follows a Fisher distribution, I got
>> the same issue:
>>
>>> print(pf(z, 1, n-2, lower=FALSE), digits=22)
>> [1] 5.079493240362495983491e-19
>>> print(integrate(df, lower=z, upper=Inf, df1=1, df2=n-2)$value, digits =
>> 22)
>> [1] 5.079015231299358486828e-19
>>> print(1-pf(z, 1, n-2, lower=TRUE), digits=22)
>> [1] 0
>>
>> When using the t.test() function, the p-value is naturally printed :
>> p-value < 2.2e-16.
>>
>> Any comment is welcome.
>>
>> Christophe
>>
>>> R.version
>>                 _
>> platform       aarch64-apple-darwin20
>> arch           aarch64
>> os             darwin20
>> system         aarch64, darwin20
>> status
>> major          4
>> minor          5.1
>> year           2025
>> month          06
>> day            13
>> svn rev        88306
>> language       R
>> version.string R version 4.5.1 (2025-06-13)
>> nickname       Great Square Root
>> -------------------------------------------------
>> Christophe DUTANG
>> LJK, Ensimag, Grenoble INP, UGA, France
>> ILB research fellow
>> Web: http://dutangc.free.fr
>> -------------------------------------------------
>>
>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> https://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Eik Vettorazzi

Universit?tsklinikum Hamburg-Eppendorf
Institut f?r Medizinische Biometrie und Epidemiologie

Christoph-Probst-Weg 1
4. Obergeschoss, Raum 04.1.021.1

20246 Hamburg

Telefon: +49 (0) 40 7410 - 58243
Fax:     +49 (0) 40 7410 - 57790

Web: www.uke.de/imbe



--

_____________________________________________________________________

Universit?tsklinikum Hamburg-Eppendorf; K?rperschaft des ?ffentlichen Rechts; Gerichtsstand: Hamburg | www.uke.de
Vorstandsmitglieder: Prof. Dr. Christian Gerloff (Vorsitzender), Joachim Pr?l?, Prof. Dr. Blanche Schwappach-Pignataro, Corinna Wriedt
_____________________________________________________________________

From pd@|gd @end|ng |rom gm@||@com  Wed Nov  5 13:28:09 2025
From: pd@|gd @end|ng |rom gm@||@com (Peter Dalgaard)
Date: Wed, 5 Nov 2025 13:28:09 +0100
Subject: [R] Did behavior of "paired" argument in t.test() change?
In-Reply-To: <20251104204021.0e690228@Tarkus>
References: <63780f63-544e-4ea4-a136-b7772a782c3e@atsu.edu>
 <20251104204021.0e690228@Tarkus>
Message-ID: <EAB00474-274F-4AE9-ACAA-867623273AB5@gmail.com>

Yes. Of course, Pair() requires the data to be in wide format. It's been a while (although not so long ago as some of the other things I cannot remember...) but I think the reason was that the  ...y~g, paired=TRUE... format was considered too brittle with respect to sort order and subsetting.

-pd


> On 4 Nov 2025, at 18.40, Ivan Krylov via R-help <r-help at r-project.org> wrote:
> 
> ? Tue, 4 Nov 2025 11:22:57 -0600
> Robert Baer via R-help <r-help at r-project.org> ?????:
> 
>> Errorin t.test.formula(value ~ time, data = data_long, paired =
>> TRUE) :
>> cannot use 'paired' in formula method
> 
> This was changed in R-4.4.0:
> https://bugs.r-project.org/show_bug.cgi?id=14359
> 
> The news item (see news(grepl('paired', Text))) recommends the use of
> Pair(x1, x2) ~ 1 instead of the 'paired' argument. A further fix is
> currently in R-devel (but not R-patched): without it, Pair(x1, x2) does
> not handle the 'subset' argument.
> 
> -- 
> Best regards,
> Ivan
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide https://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
